(this.webpackJsonpclipit=this.webpackJsonpclipit||[]).push([[0],{215:function(e,t,n){},216:function(e,t,n){"use strict";n.r(t);var r=n(1),c=n(73),a=n(231),o=n(0),i=n.n(o),u=n(29),s=n.n(u),l=n(5);var j=n(7),d=n.n(j),f=n(17),b=n(9),O=n(232),p=n(20),h=n(15),m=n(70),v=n(10),x=Object(v.pipe)(Object(v.map)((function(e){return e*e})),Object(v.pipe)(v.mean,Math.sqrt)),g=function(e){return function(t){return Object(v.pipe)(Object(v.chunk)(Math.ceil(t.length/e)),Object(v.map)(x))(t)}},w=function(e){return new Promise((function(t,n){var r=new FileReader;r.readAsArrayBuffer(e),r.onload=function(e){return t(r.result)},r.onerror=function(e){return n(new Error("Couldn't read file."))}}))},E=function(){var e=Object(f.a)(d.a.mark((function e(t){var n,r,c,a;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=[],e.next=3,w(t);case 3:return r=e.sent,e.next=6,D(r);case 6:for(c=e.sent,a=0;a<c.numberOfChannels;a++)n.push(Array.from(c.getChannelData(a)));return e.abrupt("return",n);case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),y=v.pipe(v.unzip,v.map(v.min),v.map(v.toNumber)),N=function(){var e=Object(f.a)(d.a.mark((function e(t,n){var r,c;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,E(t);case 2:return r=e.sent,c=r.map(g(n)),e.abrupt("return",1===c.length?c:[].concat(Object(h.a)(c),[y(c)]));case 5:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}();function C(e){for(var t=new Int16Array(e.length),n=0,r=e.length;n<r;n++)e[n]<0?t[n]=32768*e[n]:t[n]=32767*e[n];return t}function R(e,t){return k.apply(this,arguments)}function k(){return(k=Object(f.a)(d.a.mark((function e(t,n){var r,c,a,o=arguments;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=o.length>2&&void 0!==o[2]?o[2]:128,c=new m.Mp3Encoder(n.numberOfChannels,n.sampleRate,r),e.t0=t.length,e.next=1===e.t0||2===e.t0?5:7;break;case 5:return a=c.encodeBuffer.apply(c,Object(h.a)(t)),e.abrupt("return",new Blob([a],{type:"audio/mp3"}));case 7:throw new Error("Wrong number of channels: ".concat(n.numberOfChannels));case 8:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function _(e,t,n){var r=e.sampleRate;return function(e){switch(e.numberOfChannels){case 1:return[C(e.getChannelData(0))];case 2:return[C(e.getChannelData(0)),C(e.getChannelData(1))];default:throw new Error("Wrong number of channels: ".concat(e.numberOfChannels))}}(e).map((function(e){return e.subarray(r*t,r*n)}))}function D(e){return A.apply(this,arguments)}function A(){return(A=Object(f.a)(d.a.mark((function e(t){return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,n){var r;(new(null!==(r=window.AudioContext)&&void 0!==r?r:window.webkitAudioContext)).decodeAudioData(t,e,(function(){return n(new Error("Couldn't decode audio"))}))})));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var L=n(12),I=1200,S=0,M=0,P=I-M-0,F=120-S-0,G=Object(L.d)().domain([0,239]).range([0,P]),B=Object(L.d)().domain([0,10]).range([F,0]),T=Object(L.a)().x((function(e,t){return G(t)})).y0(F).y1((function(e){return B(e)})).curve(L.b);function q(e){var t=e.graphData,n=e.samples,c=e.currentTime,a=e.duration,i=e.trim,u=Object(o.useRef)(null);Object(o.useEffect)((function(){var e=u.current,r=null!==t?t:[Array(n).fill(.5)],c=null!==t?Object(L.c)(t.flat(2)):[0,1];B.domain(c),G.domain([0,n]),Object(L.e)(e).selectAll("path").data(r).join("path").transition().attr("d",T)}),[t,n]);var s=Object(o.useRef)(null),j=Object(L.d)().domain([0,a]).range([1,P-1]);Object(o.useEffect)((function(){Object(L.e)(s.current).datum(c).attr("x1",j).attr("x2",j).attr("y1",0).attr("y2",F)}),[c,a,j]);var d=Object(o.useRef)(null),f=Object(o.useRef)(null);return Object(o.useEffect)((function(){var e=Object(L.d)([0,a],[0,P]),t=Object(l.a)(i,2),n=t[0],r=t[1],c=d.current,o=f.current;Object(L.e)(c).datum(n).attr("width",(function(t){return e(t)})),Object(L.e)(o).datum(r).attr("x",(function(t){return e(t)})).attr("width",(function(t){return e(a-t)}))}),[i,a]),Object(o.useEffect)((function(){console.log(JSON.stringify(t))}),[t]),Object(r.jsxs)("svg",{width:I,height:120,viewBox:"0 0 ".concat(I," ").concat(120),className:"curve",children:[Object(r.jsxs)("defs",{children:[Object(r.jsxs)("g",{id:"filterMask",children:[Object(r.jsx)("rect",{x:"0",y:"0",width:"0",height:"500",ref:d}),Object(r.jsx)("rect",{x:"1200",y:"0",width:"500",height:"500",ref:f})]}),Object(r.jsxs)("filter",{id:"filter",colorInterpolationFilters:"linearRGB",children:[Object(r.jsx)("feImage",{id:"feimage",href:"#filterMask",x:"0",y:"0",result:"mask"}),Object(r.jsx)("feFlood",{floodColor:"#ffffff",floodOpacity:"1",x:"0%",y:"0%",width:"100%",height:"100%",result:"flood"}),Object(r.jsx)("feBlend",{mode:"color",x:"0%",y:"0%",width:"100%",height:"100%",in:"flood",in2:"SourceGraphic",result:"blend"}),Object(r.jsx)("feFlood",{floodColor:"#ffffff",floodOpacity:"0.666",x:"0%",y:"0%",width:"100%",height:"100%",result:"flood1"}),Object(r.jsx)("feBlend",{mode:"screen",x:"0%",y:"0%",width:"100%",height:"100%",in:"blend",in2:"flood1",result:"blend1"}),Object(r.jsx)("feComposite",{in2:"mask",in:"blend1",operator:"in",result:"comp"}),Object(r.jsxs)("feMerge",{result:"merge",children:[Object(r.jsx)("feMergeNode",{in:"SourceGraphic"}),Object(r.jsx)("feMergeNode",{in:"comp"})]})]})]}),Object(r.jsxs)("g",{transform:"translate(".concat(M,", ").concat(S,")"),children:[Object(r.jsx)("g",{ref:u,className:"curve__paths",filter:"url(#filter)",children:Object(r.jsx)("rect",{x:"0",y:"0",width:P,height:F,fill:"whitesmoke"})}),Object(r.jsx)("line",{ref:s,className:"curve__playhead"})]})]})}var U,J,X=n(30),H=n.n(X);function W(e){var t=e.status,n=e.onContent,c=e.offContent,a=e.onChange;return Object(r.jsx)("button",{onClick:function(){a&&a(!t)},className:H()("btn--toggle",t?"btn--on":"btn--off"),children:t?n:c})}!function(e){e[e.NONE=0]="NONE",e[e.READING_FILE=1]="READING_FILE",e[e.EXPORTING_MP3=2]="EXPORTING_MP3"}(J||(J={}));var z=(U={},Object(b.a)(U,J.NONE,""),Object(b.a)(U,J.READING_FILE,"Reading file"),Object(b.a)(U,J.EXPORTING_MP3,"Exporting MP3"),U);function V(e){var t=e.file,n=Object(o.useState)(!1),c=Object(l.a)(n,2),a=c[0],i=c[1],u=Object(o.useState)(0),s=Object(l.a)(u,2),j=s[0],b=s[1],h=Object(o.useState)(0),m=Object(l.a)(h,2),v=m[0],x=m[1],g=Object(o.useState)(0),w=Object(l.a)(g,2),E=w[0],y=w[1],C=Object(o.useState)(v),k=Object(l.a)(C,2),D=k[0],A=k[1],L=Object(o.useState)(!1),I=Object(l.a)(L,2),S=I[0],M=I[1],P=Object(o.useState)(J.NONE),F=Object(l.a)(P,2),G=F[0],B=F[1],T=Object(o.useState)(null),U=Object(l.a)(T,2),X=U[0],H=U[1];Object(o.useEffect)((function(){B(J.READING_FILE),N(t,300).then((function(e){H(e),B(J.NONE)}))}),[t]);var V=function(){var e=K.current;b(e.duration),y(e.duration),x(0),e.currentTime=0},K=Object(o.useRef)(null);Object(o.useEffect)((function(){K.current.onloadedmetadata=V,K.current.onplay=function(){return i(!0)},K.current.onpause=function(){return i(!1)}}));var Q=Object(o.useCallback)((function(){var e=K.current;a?e.pause():e.play()}),[a]);Object(o.useEffect)((function(){var e=K.current,t=0;return function n(){A(e.currentTime),t=requestAnimationFrame(n)}(),function(){t&&cancelAnimationFrame(t)}}),[]),Object(o.useEffect)((function(){var e=K.current;D>=E&&(e.currentTime=v,S||e.pause())}),[D,E,S,v]),Object(o.useEffect)((function(){var e=K.current;e.src=URL.createObjectURL(t),e.onload=function(){URL.revokeObjectURL(e.src)}}),[t]),Object(o.useEffect)((function(){K.current.currentTime=v}),[v]);function Y(){return(Y=Object(f.a)(d.a.mark((function e(){var n,r,c,a,o,i;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.arrayBuffer();case 2:return n=e.sent,r=new AudioContext,e.next=6,r.decodeAudioData(n);case 6:return c=e.sent,a=_(c,v,E),e.next=10,R(a,c);case 10:o=e.sent,(i=document.createElement("a")).setAttribute("download","clip.mp3"),i.setAttribute("hidden","hidden"),i.href=URL.createObjectURL(o),document.body.appendChild(i),i.click();case 17:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return Object(r.jsxs)("div",{className:"clipper",children:[Object(r.jsxs)("div",{className:"clipper__view",children:[Object(r.jsx)(q,{graphData:X,currentTime:D,duration:j,trim:[v,E],samples:300}),Object(r.jsx)(O.a,{value:[v,E],onChange:function(e,t){var n=t,r=Object(l.a)(n,2),c=r[0],a=r[1];x(c),y(a)},min:0,max:j,step:.001}),Object(r.jsx)("audio",{ref:K})]}),Object(r.jsx)("div",{className:"clipper__controls",children:Object(r.jsxs)("div",{className:"controls",children:[Object(r.jsxs)("div",{className:"controls__start",children:[Object(r.jsx)(W,{status:a,onContent:Object(r.jsx)(p.b,{}),offContent:Object(r.jsx)(p.b,{}),onChange:Q})," ",Object(r.jsx)(W,{status:S,onContent:Object(r.jsx)(p.a,{}),offContent:Object(r.jsx)(p.a,{}),onChange:function(e){return M(e)}})]}),Object(r.jsx)("div",{className:"controls__middle",children:z[G]}),Object(r.jsx)("div",{className:"controls__end",children:Object(r.jsx)("button",{onClick:function(){return Y.apply(this,arguments)},children:Object(r.jsx)(p.c,{})})})]})})]})}var K=n(14),Q=n(34),Y={accept:"audio/mpeg",multiple:!1};function Z(e){var t=e.children,n=e.onDrop,c=e.isHidden,a=Object(Q.a)(Object(K.a)(Object(K.a)({},Y),{},{onDrop:n})),o=a.getRootProps,i=a.getInputProps,u=a.isDragActive,s=a.isDragReject;return Object(r.jsxs)("div",Object(K.a)(Object(K.a)({className:H()("drop-area",u&&"drop-area--active",s&&"drop-area--rejected",c&&"drop-area--hidden")},o()),{},{children:[Object(r.jsx)("input",Object(K.a)({},i())),t]}))}function $(e){var t=e.onDrop,n=Object(Q.a)(Object(K.a)(Object(K.a)({},Y),{},{noClick:!0,onDrop:t}));return Object(r.jsxs)("div",{children:[Object(r.jsx)("button",{onClick:n.open,children:"Selecione um arquivo"}),Object(r.jsx)("input",Object(K.a)({},n.getInputProps()))]})}function ee(){var e=Object(o.useState)(null),t=Object(l.a)(e,2),n=t[0],c=t[1],a=function(){var e=Object(o.useState)(!1),t=Object(l.a)(e,2),n=t[0],r=t[1];return Object(o.useEffect)((function(){var e=0;function t(e){e.preventDefault()}function n(t){e++,o()}function c(t){e--,o()}function a(t){e=0,o()}function o(){r(e>0)}return window.addEventListener("dragover",t),window.addEventListener("dragenter",n),window.addEventListener("dragleave",c),window.addEventListener("drop",a),function(){window.removeEventListener("dragover",t),window.removeEventListener("dragenter",n),window.removeEventListener("dragleave",c),window.removeEventListener("drop",a)}}),[]),n}(),i=Object(o.useCallback)((function(e){e.length<1||c(e[0])}),[]);return Object(r.jsxs)("div",{className:"app",children:[Object(r.jsx)("div",{className:"layout",children:Object(r.jsxs)("main",{className:"layout__content",children:[Object(r.jsx)("h1",{children:"Clipit"}),!n&&Object(r.jsxs)("div",{className:"begin text--center",children:[Object(r.jsx)("p",{children:"Para come\xe7ar, selecione um arquivo MP3 no seu computador. Voc\xea tamb\xe9m pode arrastar e soltar o arquivo em qualquer lugar da p\xe1gina."}),Object(r.jsx)($,{onDrop:i}),Object(r.jsx)("p",{})]}),n&&Object(r.jsx)(V,{file:n})]})}),Object(r.jsx)(Z,{isHidden:!a,onDrop:i,children:"\ud83d\udd25 drop it like it's hot \ud83d\udd25"})]})}n(215);var te=Object(c.a)({palette:{primary:{main:"#8134af"}}});s.a.render(Object(r.jsx)(i.a.StrictMode,{children:Object(r.jsx)(a.a,{theme:te,children:Object(r.jsx)(ee,{})})}),document.getElementById("root"))}},[[216,1,2]]]);
//# sourceMappingURL=main.76fe3061.chunk.js.map