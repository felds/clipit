{"version":3,"sources":["util/sound.ts","components/curve.tsx","components/toggle-button.tsx","components/clipper.tsx","settings.ts","components/droparea.tsx","components/select-file.tsx","components/app.tsx","hooks/useDraggingOver.ts","index.tsx"],"names":["rms","pipe","map","x","mean","Math","sqrt","processChannel","samples","channelData","chunk","ceil","length","loadFileAsArrayBuffer","file","Promise","resolve","reject","reader","FileReader","readAsArrayBuffer","onload","e","result","onerror","Error","getChannels","a","channels","audioContext","window","webkitAudioContext","AudioContext","buffer","decodeAudioData","audioData","i","numberOfChannels","push","Array","from","getChannelData","getBaseline","_","loadAudioData","processedChannels","width","margin","innerWidth","innerHeight","xScale","scaleLinear","domain","numberOfSamples","range","yScale","shape","area","y0","y1","d","curve","curveBasis","Curve","currentTime","duration","trim","useState","data","setData","pathsRef","useRef","useEffect","dom","extent","flat","select","current","selectAll","join","transition","attr","then","playheadRef","playheadScale","datum","startMaskRef","endMaskRef","durationScale","start","end","startMask","endMask","height","viewBox","className","id","y","ref","colorInterpolationFilters","href","floodColor","floodOpacity","mode","in","in2","operator","transform","filter","fill","ToggleButton","status","onContent","offContent","onChange","onClick","classNames","Clipper","isPlaying","setPlaying","setDuration","startTime","setStartTime","endTime","setEndTime","setCurrentTime","loop","setLoop","updateMetadata","audio","audioRef","onloadedmetadata","onplay","onpause","playPause","useCallback","pause","play","animationFrame","tick","requestAnimationFrame","cancelAnimationFrame","src","URL","createObjectURL","addEventListener","revokeUrl","revokeObjectURL","removeEventListener","Slider","value","newValue","min","max","step","dropzone","accept","multiple","DropArea","children","onDrop","isHidden","useDropzone","getRootProps","getInputProps","isDragActive","isDragReject","SelectFile","dropz","noClick","open","App","setFile","isDraggingOver","setDraggingOver","dragCount","handleDragOver","preventDefault","handleDragEnter","update","handleDragLeave","handleDrop","useDraggingOver","acceptedFiles","ReactDOM","render","StrictMode","document","getElementById"],"mappings":"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","file":"static/js/main.6edbaf6b.chunk.js","sourcesContent":["import * as _ from \"lodash/fp\";\nimport { chunk, map, mean, pipe } from \"lodash/fp\";\n\ninterface Window {\n  webkitAudioContext?: typeof AudioContext;\n}\ndeclare const window: Window;\n\nexport const rms = pipe(\n  map((x: number) => x * x),\n  mean,\n  Math.sqrt,\n);\n\nexport const processChannel = (samples: number) => (\n  channelData: number[],\n): number[] =>\n  pipe(chunk(Math.ceil(channelData.length / samples)), map(rms))(channelData);\n\nexport const loadFileAsArrayBuffer = (file: File): Promise<ArrayBuffer> =>\n  new Promise((resolve, reject) => {\n    const reader = new FileReader();\n    reader.readAsArrayBuffer(file);\n    reader.onload = (e) => resolve(reader.result as ArrayBuffer);\n    reader.onerror = (e) => reject(new Error(\"Couldn't read file.\"));\n  });\n\nexport const getChannels = async (file: File): Promise<number[][]> => {\n  const channels: number[][] = [];\n  const audioContext = window.webkitAudioContext\n    ? new window.webkitAudioContext()\n    : new AudioContext();\n  const buffer = await loadFileAsArrayBuffer(file);\n  const audioData = await audioContext.decodeAudioData(buffer);\n  for (let i = 0; i < audioData.numberOfChannels; i++) {\n    channels.push(Array.from(audioData.getChannelData(i)));\n  }\n  return channels;\n};\n\n// export const getBaseline = (channels: number[][]) => unzip(channels)\nconst getBaseline = _.pipe(_.unzip, _.map(_.min), _.map(_.toNumber));\n\nexport const loadAudioData = async (\n  file: File,\n  samples: number,\n): Promise<number[][]> => {\n  const audioData = await getChannels(file);\n  const processedChannels = audioData.map(processChannel(samples));\n\n  return processedChannels.length === 1\n    ? processedChannels\n    : [...processedChannels, getBaseline(processedChannels)];\n};\n","import { area, curveBasis, extent, scaleLinear, select } from \"d3\";\nimport React, { useEffect, useRef, useState } from \"react\";\nimport { loadAudioData } from \"../util/sound\";\n\n/**\n * @todo send the audio processing to a worker\n */\n\nconst width = 1200;\nconst height = 120;\nconst margin = { top: 0, right: 0, bottom: 0, left: 0 };\nconst innerWidth = width - margin.left - margin.right;\nconst innerHeight = height - margin.top - margin.bottom;\nconst numberOfSamples = width / 5;\n\n// d3 configs\nconst xScale = scaleLinear()\n  .domain([0, numberOfSamples - 1])\n  .range([0, innerWidth]);\nconst yScale = scaleLinear().domain([0, 10]).range([innerHeight, 0]);\nconst shape = area<number>()\n  .x((_, i) => xScale(i))\n  .y0(innerHeight)\n  .y1((d) => yScale(d))\n  .curve(curveBasis);\n\ntype CurveProps = {\n  file: File;\n  currentTime: number;\n  duration: number;\n  trim: [start: number, end: number];\n};\nexport default function Curve({\n  file,\n  currentTime,\n  duration,\n  trim,\n}: CurveProps) {\n  const [data, setData] = useState<number[][]>([]);\n  const pathsRef = useRef<SVGGElement>(null);\n\n  // update the graph when de data changes\n  useEffect(() => {\n    const dom = extent(data.flat(2)) as [number, number];\n    yScale.domain(dom);\n\n    select(pathsRef.current!)\n      .selectAll(\"path\")\n      .data(data)\n      .join(\"path\")\n      .transition()\n      .attr(\"d\", shape);\n  }, [data]);\n\n  // update data when file changes\n  useEffect(() => {\n    loadAudioData(file, numberOfSamples).then(setData);\n  }, [file]);\n\n  // playhead\n  const playheadRef = useRef<SVGLineElement>(null);\n  const playheadScale = scaleLinear()\n    .domain([0, duration])\n    .range([1, innerWidth - 1]);\n  useEffect(() => {\n    select(playheadRef.current!)\n      .datum(currentTime)\n      .attr(\"x1\", playheadScale)\n      .attr(\"x2\", playheadScale)\n      .attr(\"y1\", 0)\n      .attr(\"y2\", innerHeight);\n  }, [currentTime, duration, playheadScale]);\n\n  // mask\n  const startMaskRef = useRef<SVGRectElement>(null);\n  const endMaskRef = useRef<SVGRectElement>(null);\n  useEffect(() => {\n    const durationScale = scaleLinear([0, duration], [0, innerWidth]);\n    const [start, end] = trim;\n    const startMask = startMaskRef.current;\n    const endMask = endMaskRef.current;\n\n    select(startMask)\n      .datum(start)\n      .attr(\"width\", (d) => durationScale(d));\n    select(endMask)\n      .datum(end)\n      .attr(\"x\", (d) => durationScale(d))\n      .attr(\"width\", (d) => durationScale(duration - d));\n  }, [trim, duration]);\n  // ---------------------------\n\n  return (\n    <svg\n      width={width}\n      height={height}\n      viewBox={`0 0 ${width} ${height}`}\n      className=\"curve\"\n    >\n      <defs>\n        <g id=\"filterMask\">\n          <rect x=\"0\" y=\"0\" width=\"0\" height=\"500\" ref={startMaskRef} />\n          <rect x=\"1200\" y=\"0\" width=\"500\" height=\"500\" ref={endMaskRef} />\n        </g>\n\n        <filter id=\"filter\" colorInterpolationFilters=\"linearRGB\">\n          <feImage id=\"feimage\" href=\"#filterMask\" x=\"0\" y=\"0\" result=\"mask\" />\n          <feFlood\n            floodColor=\"#ffffff\"\n            floodOpacity=\"1\"\n            x=\"0%\"\n            y=\"0%\"\n            width=\"100%\"\n            height=\"100%\"\n            result=\"flood\"\n          />\n          <feBlend\n            mode=\"color\"\n            x=\"0%\"\n            y=\"0%\"\n            width=\"100%\"\n            height=\"100%\"\n            in=\"flood\"\n            in2=\"SourceGraphic\"\n            result=\"blend\"\n          />\n          <feFlood\n            floodColor=\"#ffffff\"\n            floodOpacity=\"0.666\"\n            x=\"0%\"\n            y=\"0%\"\n            width=\"100%\"\n            height=\"100%\"\n            result=\"flood1\"\n          />\n          <feBlend\n            mode=\"screen\"\n            x=\"0%\"\n            y=\"0%\"\n            width=\"100%\"\n            height=\"100%\"\n            in=\"blend\"\n            in2=\"flood1\"\n            result=\"blend1\"\n          />\n          <feComposite in2=\"mask\" in=\"blend1\" operator=\"in\" result=\"comp\" />\n          <feMerge result=\"merge\">\n            <feMergeNode in=\"SourceGraphic\" />\n            <feMergeNode in=\"comp\" />\n          </feMerge>\n        </filter>\n      </defs>\n\n      <g transform={`translate(${margin.left}, ${margin.top})`}>\n        <g ref={pathsRef} className=\"curve__paths\" filter=\"url(#filter)\">\n          <rect\n            x=\"0\"\n            y=\"0\"\n            width={innerWidth}\n            height={innerHeight}\n            fill=\"whitesmoke\"\n          />\n        </g>\n        <line ref={playheadRef} className=\"curve__playhead\" />\n      </g>\n    </svg>\n  );\n}\n","import classNames from \"classnames\";\nimport React from \"react\";\n\ntype ToggleButtonProps = {\n  status: boolean;\n  onContent: React.ReactNode;\n  offContent: React.ReactNode;\n  onChange?(status: boolean): void;\n};\nexport default function ToggleButton({\n  status,\n  onContent,\n  offContent,\n  onChange,\n}: ToggleButtonProps) {\n  const handleClick = () => {\n    if (onChange) onChange(!status);\n  };\n\n  return (\n    <button\n      onClick={handleClick}\n      className={classNames(\"btn--toggle\", status ? \"btn--on\" : \"btn--off\")}\n    >\n      {status ? onContent : offContent}\n    </button>\n  );\n}\n","import Slider from \"@material-ui/core/Slider\";\nimport React, { useCallback, useEffect, useRef, useState } from \"react\";\nimport { IoIosInfinite, IoIosPlay } from \"react-icons/io\";\nimport Curve from \"./curve\";\nimport ToggleButton from \"./toggle-button\";\n\ntype ClipperProps = {\n  file: File;\n};\nexport default function Clipper({ file }: ClipperProps) {\n  const [isPlaying, setPlaying] = useState(false);\n  const [duration, setDuration] = useState(0);\n  const [startTime, setStartTime] = useState(0);\n  const [endTime, setEndTime] = useState(0);\n  const [currentTime, setCurrentTime] = useState(startTime);\n  const [loop, setLoop] = useState(false);\n\n  const updateMetadata = () => {\n    const audio = audioRef.current!;\n    setDuration(audio.duration);\n    setEndTime(audio.duration);\n    setStartTime(0);\n    audio.currentTime = 0;\n  };\n\n  const audioRef = useRef<HTMLAudioElement>(null);\n  useEffect(() => {\n    audioRef.current!.onloadedmetadata = updateMetadata;\n    audioRef.current!.onplay = () => setPlaying(true);\n    audioRef.current!.onpause = () => setPlaying(false);\n  });\n\n  const playPause = useCallback(() => {\n    const audio = audioRef.current!;\n    if (isPlaying) {\n      audio.pause();\n    } else {\n      audio.play();\n    }\n  }, [isPlaying]);\n\n  // update currentTime\n  useEffect(() => {\n    const audio = audioRef.current!;\n    let animationFrame = 0;\n    const tick = () => {\n      setCurrentTime(audio.currentTime);\n      animationFrame = requestAnimationFrame(tick);\n    };\n    tick();\n    return () => {\n      if (animationFrame) cancelAnimationFrame(animationFrame);\n    };\n  }, []);\n\n  // go back to start time after playing\n  useEffect(() => {\n    const audio = audioRef.current!;\n    if (currentTime >= endTime) {\n      audio.currentTime = startTime;\n      if (!loop) {\n        audio.pause();\n      }\n    }\n  }, [currentTime, endTime, loop, startTime]);\n\n  // load dropped file into the audio element\n  useEffect(() => {\n    const audio = audioRef.current!;\n    audio.src = URL.createObjectURL(file);\n    const revokeUrl = () => {\n      URL.revokeObjectURL(audio.src);\n      audio.removeEventListener(\"load\", revokeUrl);\n    };\n    audio.addEventListener(\"load\", revokeUrl);\n  }, [file]);\n\n  // sync current time with start time\n  useEffect(() => {\n    const audio = audioRef.current!;\n    audio.currentTime = startTime;\n  }, [startTime]);\n\n  const handleSelection = (range: [start: number, end: number] | null) => {\n    if (!range) {\n      setStartTime(0);\n      setEndTime(duration);\n    } else {\n      setStartTime(range[0] * duration);\n      setEndTime(range[1] * duration);\n    }\n  };\n\n  return (\n    <div className=\"clipper\">\n      <div className=\"clipper__view\">\n        <Curve\n          file={file}\n          currentTime={currentTime}\n          duration={duration}\n          trim={[startTime, endTime]}\n        />\n        <Slider\n          value={[startTime, endTime]}\n          onChange={(e, newValue) => {\n            const [start, end] = newValue as [number, number];\n            setStartTime(start);\n            setEndTime(end);\n          }}\n          min={0}\n          max={duration}\n          step={0.001}\n        />\n        <audio ref={audioRef} />\n      </div>\n\n      <div className=\"clipper__controls\">\n        <ToggleButton\n          status={isPlaying}\n          onContent={<IoIosPlay />}\n          offContent={<IoIosPlay />}\n          onChange={playPause}\n        />{\" \"}\n        <ToggleButton\n          status={loop}\n          onContent={<IoIosInfinite />}\n          offContent={<IoIosInfinite />}\n          onChange={(loop) => setLoop(loop)}\n        />\n      </div>\n    </div>\n  );\n}\n","export const dropzone = { accept: \"audio/mpeg\", multiple: false };\n","import classNames from \"classnames\";\nimport React from \"react\";\nimport { useDropzone } from \"react-dropzone\";\nimport { dropzone } from \"../settings\";\n\ntype DropAreaProps = {\n  children: React.ReactNode;\n  isHidden: boolean;\n  onDrop: (acceptedFiles: File[]) => void;\n};\nexport default function DropArea({\n  children,\n  onDrop,\n  isHidden,\n}: DropAreaProps) {\n  const {\n    getRootProps,\n    getInputProps,\n    isDragActive,\n    isDragReject,\n  } = useDropzone({ ...dropzone, onDrop });\n\n  return (\n    <div\n      className={classNames(\n        \"drop-area\",\n        isDragActive && \"drop-area--active\",\n        isDragReject && \"drop-area--rejected\",\n        isHidden && \"drop-area--hidden\",\n      )}\n      {...getRootProps()}\n    >\n      <input {...getInputProps()} />\n      {children}\n    </div>\n  );\n}\n","import React from \"react\";\nimport { useDropzone } from \"react-dropzone\";\nimport { dropzone } from \"../settings\";\n\nexport default function SelectFile({ onDrop }) {\n  const dropz = useDropzone({\n    ...dropzone,\n    noClick: true,\n    onDrop,\n  });\n\n  return (\n    <div>\n      <button onClick={dropz.open}>Selecione um arquivo</button>\n      <input {...dropz.getInputProps()} />\n    </div>\n  );\n}\n","import React, { useCallback, useState } from \"react\";\nimport useDraggingOver from \"../hooks/useDraggingOver\";\nimport Clipper from \"./clipper\";\nimport DropArea from \"./droparea\";\nimport SelectFile from \"./select-file\";\n\nexport default function App() {\n  const [file, setFile] = useState<File | null>(null);\n  const isDraggingOver = useDraggingOver();\n\n  const onDrop = useCallback((acceptedFiles: File[]) => {\n    if (acceptedFiles.length < 1) return;\n    setFile(acceptedFiles[0]);\n  }, []);\n\n  return (\n    <div className=\"app\">\n      <div className=\"layout\">\n        {/* <nav className=\"layout__nav\"></nav> */}\n        <main className=\"layout__content\">\n          <h1>Clipit</h1>\n          {!file && (\n            <div className=\"begin text--center\">\n              <p>\n                Para começar, selecione um arquivo MP3 no seu computador. Você\n                também pode arrastar e soltar o arquivo em qualquer lugar da\n                página.\n              </p>\n              <SelectFile onDrop={onDrop} />\n              <p></p>\n            </div>\n          )}\n          {file && <Clipper file={file} />}\n        </main>\n        {/* <footer className=\"layout__footer\"></footer> */}\n      </div>\n\n      <DropArea isHidden={!isDraggingOver} onDrop={onDrop}>\n        🔥 drop it like it's hot 🔥\n      </DropArea>\n    </div>\n  );\n}\n","import { useEffect, useState } from \"react\";\n\nexport default function useDraggingOver() {\n  const [isDraggingOver, setDraggingOver] = useState(false);\n\n  useEffect(() => {\n    let dragCount = 0;\n\n    function handleDragOver(e: DragEvent) {\n      e.preventDefault();\n    }\n    function handleDragEnter(e: DragEvent) {\n      dragCount++;\n      update();\n    }\n    function handleDragLeave(e: DragEvent) {\n      dragCount--;\n      update();\n    }\n    function handleDrop(e: DragEvent) {\n      dragCount = 0;\n      update();\n    }\n    function update() {\n      setDraggingOver(dragCount > 0);\n    }\n\n    window.addEventListener(\"dragover\", handleDragOver);\n    window.addEventListener(\"dragenter\", handleDragEnter);\n    window.addEventListener(\"dragleave\", handleDragLeave);\n    window.addEventListener(\"drop\", handleDrop);\n\n    return () => {\n      window.removeEventListener(\"dragover\", handleDragOver);\n      window.removeEventListener(\"dragenter\", handleDragEnter);\n      window.removeEventListener(\"dragleave\", handleDragLeave);\n      window.removeEventListener(\"drop\", handleDrop);\n    };\n  }, []);\n\n  return isDraggingOver;\n}\n","import React from \"react\";\nimport ReactDOM from \"react-dom\";\nimport App from \"./components/app\";\nimport \"./styles.css\";\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById(\"root\"),\n);\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\n// import * as serviceWorker from './serviceWorker';\n// serviceWorker.unregister();\n"],"sourceRoot":""}